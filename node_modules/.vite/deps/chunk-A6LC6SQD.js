// node_modules/@storyblok/field-plugin/dist/field-plugin.js
var i = (e, t) => typeof e == "object" && e !== null && t in e;
var y = (e) => i(e, "name") && typeof e.name == "string" && i(e, "value") && typeof e.value == "string";
var v = (e) => i(e, "field_type") && typeof e.field_type == "string" && i(e, "options") && Array.isArray(e.options) && e.options.every(y);
var l = (e) => i(e, "action") && typeof e.action == "string" && i(e, "uid") && typeof e.uid == "string";
var f = (e) => i(e, "content") && typeof e.content == "object" && e.content !== null && !Array.isArray(e.content);
var m = (e) => l(e) && i(e, "language") && typeof e.language == "string" && e.action === "loaded" && i(e, "schema") && v(e.schema) && i(e, "story") && f(e.story);
var w = (e) => e.reduce((t, s) => (t[s.name] = s.value, t), {});
var M = (e) => i(e, "filename") && typeof e.filename == "string";
var C = (e) => {
  const { uid: t, action: s, field: n, ...r } = e;
  return r;
};
var S = (e) => l(e) && e.action === "asset-selected" && P(e) && M(e);
var P = (e) => !i(e, "field") || typeof e.field > "u" ? true : typeof e.field == "string";
var A = (e) => l(e) && e.action === "get-context" && i(e, "story") && f(e.story);
var a = (e) => i(e, "action") && e.action === "plugin-changed" && i(e, "uid") && typeof e.uid == "string" && i(e, "event") && typeof e.event == "string";
var J = (e) => a(e) && e.event === "update" && i(e, "model");
var x = (e, t) => ({
  action: "plugin-changed",
  event: "update",
  uid: e,
  model: t
});
var K = (e) => a(e) && e.event === "toggleModal" && i(e, "status") && typeof e.status == "boolean";
var F = (e, t) => ({
  action: "plugin-changed",
  event: "toggleModal",
  uid: e,
  status: t
});
var N = (e) => a(e) && e.event === "loaded";
var L = (e) => ({
  action: "plugin-changed",
  event: "loaded",
  uid: e
});
var Q = (e) => a(e) && e.event === "heightChange" && i(e, "height") && typeof e.height == "number";
var R = (e, t) => ({
  action: "plugin-changed",
  event: "heightChange",
  uid: e,
  height: t
});
var T = (e) => a(e) && e.event === "getContext";
var k = (e) => ({
  action: "plugin-changed",
  event: "getContext",
  uid: e
});
var V = (e) => a(e) && e.event === "showAssetModal" && E(e);
var E = (e) => !i(e, "field") || typeof e.field > "u" ? true : typeof e.field == "string";
var O = (e, t) => ({
  action: "plugin-changed",
  event: "showAssetModal",
  uid: e,
  field: t
});
var Y = (e) => `${e.secure ? "https" : "http"}://${e.host}`;
var $ = (e) => {
  const t = new URLSearchParams(e), s = t.get("uid") ?? void 0, n = t.get("protocol") ?? void 0, r = t.get("host") ?? void 0, d = t.get("preview") ?? void 0;
  return n !== "http:" && n !== "https:" || typeof s > "u" || typeof r > "u" ? void 0 : {
    uid: s,
    secure: n === "https:",
    host: r,
    preview: typeof d < "u"
  };
};
var W = (e) => {
  const t = new URLSearchParams({
    protocol: e.secure ? "https:" : "http:",
    host: e.host,
    uid: e.uid
  });
  return e.preview && t.set("preview", "1"), t.toString();
};
var q = (e) => ({
  spaceId: e.spaceId ?? void 0,
  story: e.story ?? void 0,
  storyId: e.storyId ?? void 0,
  storyLang: e.language === "" ? "default" : e.language,
  blockUid: e.blockId ?? void 0,
  token: e.token ?? void 0,
  options: w(e.schema.options),
  uid: e.uid ?? void 0,
  content: e.model ?? void 0
});
var I = (e) => ({
  story: e.story ?? void 0
});
var b = {
  isModalOpen: false,
  content: void 0,
  options: {},
  storyLang: "default",
  story: { content: {} },
  blockUid: void 0,
  storyId: void 0,
  token: void 0,
  uid: "-preview",
  spaceId: void 0
};
var U = (e, t, s) => {
  let n = b, r;
  return {
    actions: {
      setContent: (o) => {
        const c = (
          // This is not safe: if the user pass a function to setContent(),
          //  this code assumes that it is an updater function
          // eslint-disable-next-line @typescript-eslint/ban-ts-comment
          // @ts-ignore
          typeof o == "function" ? o(n.content) : o
        );
        t(x(e, c)), n = {
          ...n,
          content: c
        }, s(n);
      },
      setModalOpen: (o) => {
        const c = typeof o == "function" ? o(n.isModalOpen) : o;
        t(F(e, c)), n = {
          ...n,
          isModalOpen: c
        }, s(n);
      },
      selectAsset: () => new Promise((o) => {
        r = o, t(O(e));
      }),
      requestContext: () => t(k(e))
    },
    messageCallbacks: {
      onStateChange: (o) => {
        n = {
          ...n,
          ...q(o)
        }, s(n);
      },
      onContextRequest: (o) => {
        n = {
          ...n,
          ...I(o)
        }, s(n);
      },
      onAssetSelect: (o) => {
        r == null || r(C(o));
      },
      onUnknownMessage: (o) => {
        console.debug(
          `Plugin received a message from container of an unknown action type "${o.action}". You may need to upgrade the version of the @storyblok/field-plugin library. Full message: ${JSON.stringify(
            o
          )}`
        );
      }
    }
  };
};
var _ = (e, t) => {
  const s = () => {
    t(R(e, document.body.clientHeight));
  }, n = new ResizeObserver(s);
  return n.observe(document.body), () => {
    n.disconnect();
  };
};
var z = () => {
  const e = document == null ? void 0 : document.querySelector(
    'link[href^="https://plugins.storyblok.com"]'
  );
  return e == null || e.setAttribute("disabled", ""), () => {
    e == null || e.removeAttribute("disabled");
  };
};
var D = (e, t, s) => {
  l(e) && e.uid === t && (m(e) ? s.onStateChange(e) : A(e) ? s.onContextRequest(e) : S(e) ? s.onAssetSelect(e) : s.onUnknownMessage(e));
};
var H = (e, t) => {
  const s = (n) => {
    D(n.data, e, t);
  };
  return window.addEventListener("message", s, false), () => {
    window.removeEventListener("message", s, false);
  };
};
var B = "https://plugin-sandbox.storyblok.com/field-plugin/";
var G = () => {
  const e = new URLSearchParams({
    url: window.location.href
  }).toString();
  return `${B}?${e}`;
};
var X = (e) => {
  if (!(window.parent !== window))
    return e({
      type: "error",
      error: new Error(
        `The window is not embedded within another window. Did you mean to open the field plugin in the sandbox? ${G()}`
      )
    }), () => {
    };
  const s = $(window.location.search);
  if (!s)
    return e({
      type: "error",
      error: new Error(
        "The URL parameters does not match the expected format."
      )
    }), () => {
    };
  const { uid: n } = s, r = (o) => {
    const c = "*";
    window.parent.postMessage(o, c);
  }, d = _(n, r), g = z(), { actions: u, messageCallbacks: h } = U(
    n,
    r,
    (o) => {
      e({
        type: "loaded",
        data: o,
        actions: u
      });
    }
  );
  r(L(n));
  const p = H(
    s.uid,
    h
  );
  return () => {
    p(), d(), g();
  };
};

export {
  y,
  v,
  l,
  f,
  m,
  w,
  M,
  C,
  S,
  P,
  A,
  a,
  J,
  x,
  K,
  F,
  N,
  L,
  Q,
  R,
  T,
  k,
  V,
  O,
  Y,
  $,
  W,
  X
};
//# sourceMappingURL=chunk-A6LC6SQD.js.map
